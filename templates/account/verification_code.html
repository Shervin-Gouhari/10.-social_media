{% extends "base.html" %}
{% load static %}
{% block title %} Verify {% endblock title %}
{% block style %}<link rel="stylesheet" href="{% static 'css/main.css' %}">{% endblock style %}

{% block content %}
<span id="root">
  <section class="section-all">
    <main class="main" role="main">
      <div class="wrapper">
        <article class="article">
          <div class="content">
            <div class="login-box">
              <div class="header">
                <img class="logo" src="{% static 'image/Instagram_logo.png' %}" alt="Instagram">
              </div>
              <h1>Please insert the verification code received by your phone number.</h1>
              <div class="form-wrap">
                <form class="form" method="POST">
                  {% csrf_token %}
                  <div class="input-box">
                    <input
                      placeholder="Enter your code"
                      id="id_verification_code"
                      type="text"
                      name="verification_code"
                      class="numberinput form-control {% if form.verification_code.errors %} is-invalid {% endif %}"
                      maxlength="5"
                      aria-required="true"
                      required
                    />
                    <div class="invalid-feedback"><strong>{{form.verification_code.errors}}</strong></div>
                  </div>
                  <span class="button-box">
                    <button class="btn" type="submit" name="submit">Verify</button>
                  </span>
                  <a class="forgot" href="{% url 'password_reset' %}">Forgot password?</a>
                </form>
              </div>
            </div>
            <div class="login-box">
              <p class="text">Didn't you receive sms?<a href="{% url 'verification_code' %}">Resend</a></p>
            </div>
          </div>
        </article>
      </div>
    </main>
  </section>
</span>

<script>
let messages = document.getElementsByClassName("messages");
Array.from(messages).forEach((e) => {
    if (e.innerText.includes("You must wait")) {
        setInterval(() => {
            let num = e.innerText.match(/\d+/g);
            if (num > 0) {
                e.innerText = `You must wait "${num - 1}" seconds before retrying.`;
            } else location.reload();
        }, 1000);
    }
});
</script>
{% endblock content %}
